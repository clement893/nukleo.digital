<!DOCTYPE html>
<html lang="en">

  <head>
    <meta charset="UTF-8" />
    <meta
      name="viewport"
      content="width=device-width, initial-scale=1.0, maximum-scale=1" />
    <title>Nukleo Digital</title>
    
    <!-- DNS prefetch and preconnect for faster loading -->
    <link rel="dns-prefetch" href="https://fonts.googleapis.com" />
    <link rel="dns-prefetch" href="https://fonts.gstatic.com" />
    <link rel="dns-prefetch" href="https://api.manus.im" />
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    
    <!-- Favicons -->
    <link rel="icon" type="image/x-icon" href="/favicon.ico" />
    <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png" />
    <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png" />
    <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png" />
    
    <!-- PWA Manifest -->
    <link rel="manifest" href="/manifest.json" />
    <meta name="theme-color" content="#7c3aed" />
    
    <!-- Preload critical fonts for better performance -->
    <link rel="preload" href="/fonts/AktivGrotesk-Regular.woff2" as="font" type="font/woff2" crossorigin />
    <link rel="preload" href="/fonts/AktivGrotesk-Medium.woff2" as="font" type="font/woff2" crossorigin />
    <link rel="preload" href="/fonts/AktivGrotesk-Bold.woff2" as="font" type="font/woff2" crossorigin />
    
    <!-- Preload LCP image (LEO avatar) -->
    <link rel="preload" href="/leo-avatar.webp" as="image" type="image/webp" fetchpriority="high" />
    
    <!-- Preload logo for loader -->
    <link rel="preload" href="/nukleo-logo.svg" as="image" type="image/svg+xml" fetchpriority="high" />
  </head>

  <body>
    <!-- PERCUTANT LOADER -->
    <style>
      @keyframes grain-shift {
        0%, 100% { opacity: 1; }
        50% { opacity: 0.7; }
      }
      
      @keyframes energy-pulse {
        0%, 100% { 
          transform: scale(1);
          opacity: 0.8;
        }
        50% { 
          transform: scale(1.5);
          opacity: 0;
        }
      }
      
      @keyframes logo-mega-pulse {
        0%, 100% { 
          transform: scale(1) rotate(0deg);
          filter: drop-shadow(0 0 30px rgba(168, 85, 247, 0.8)) 
                  drop-shadow(0 0 60px rgba(236, 72, 153, 0.6))
                  drop-shadow(0 0 90px rgba(59, 130, 246, 0.4));
        }
        25% { 
          transform: scale(1.15) rotate(2deg);
          filter: drop-shadow(0 0 50px rgba(168, 85, 247, 1)) 
                  drop-shadow(0 0 100px rgba(236, 72, 153, 0.9))
                  drop-shadow(0 0 150px rgba(59, 130, 246, 0.7));
        }
        50% { 
          transform: scale(1.1) rotate(-2deg);
          filter: drop-shadow(0 0 40px rgba(236, 72, 153, 1)) 
                  drop-shadow(0 0 80px rgba(59, 130, 246, 0.9))
                  drop-shadow(0 0 120px rgba(168, 85, 247, 0.7));
        }
        75% { 
          transform: scale(1.15) rotate(2deg);
          filter: drop-shadow(0 0 50px rgba(59, 130, 246, 1)) 
                  drop-shadow(0 0 100px rgba(168, 85, 247, 0.9))
                  drop-shadow(0 0 150px rgba(236, 72, 153, 0.7));
        }
      }
      
      @keyframes particle-orbit {
        0% { 
          transform: rotate(0deg) translateX(150px) rotate(0deg);
          opacity: 0;
        }
        10% {
          opacity: 1;
        }
        90% {
          opacity: 1;
        }
        100% { 
          transform: rotate(360deg) translateX(150px) rotate(-360deg);
          opacity: 0;
        }
      }
      
      @keyframes glitch-text {
        0%, 100% { 
          transform: translate(0);
          text-shadow: 0 0 30px rgba(168, 85, 247, 0.8);
        }
        10% { 
          transform: translate(-5px, 5px);
          text-shadow: -5px 5px 20px rgba(236, 72, 153, 1), 5px -5px 20px rgba(59, 130, 246, 1);
        }
        20% { 
          transform: translate(5px, -5px);
          text-shadow: 5px -5px 20px rgba(59, 130, 246, 1), -5px 5px 20px rgba(168, 85, 247, 1);
        }
        30% { 
          transform: translate(-3px, -3px);
          text-shadow: -3px -3px 20px rgba(168, 85, 247, 1), 3px 3px 20px rgba(236, 72, 153, 1);
        }
        40% { 
          transform: translate(0);
          text-shadow: 0 0 30px rgba(236, 72, 153, 0.8);
        }
      }
      
      @keyframes progress-glow {
        0%, 100% { 
          box-shadow: 0 0 20px rgba(168, 85, 247, 0.5);
        }
        33% { 
          box-shadow: 0 0 40px rgba(236, 72, 153, 0.8), 0 0 60px rgba(168, 85, 247, 0.5);
        }
        66% { 
          box-shadow: 0 0 40px rgba(59, 130, 246, 0.8), 0 0 60px rgba(236, 72, 153, 0.5);
        }
      }
      
      #app-loader {
        position: fixed;
        inset: 0;
        background: linear-gradient(135deg, 
          rgb(107,23,22) 0%, 
          rgb(40,60,120) 50%, 
          rgb(107,23,22) 100%);
        display: flex;
        align-items: center;
        justify-content: center;
        z-index: 9999;
        overflow: hidden;
      }
      
      /* Grain animé avec canvas */
      #app-loader canvas {
        position: absolute;
        inset: 0;
        width: 100%;
        height: 100%;
        opacity: 0.5;
        mix-blend-mode: overlay;
        pointer-events: none;
        animation: grain-shift 0.5s infinite;
      }
      
      /* Ondes d'énergie */
      #app-loader .energy-waves {
        position: absolute;
        inset: 0;
        display: flex;
        align-items: center;
        justify-content: center;
        pointer-events: none;
      }
      
      #app-loader .energy-wave {
        position: absolute;
        width: 200px;
        height: 200px;
        border: 3px solid rgba(168, 85, 247, 0.6);
        border-radius: 50%;
        animation: energy-pulse 2s ease-out infinite;
      }
      
      #app-loader .energy-wave:nth-child(2) {
        animation-delay: 0.4s;
        border-color: rgba(236, 72, 153, 0.6);
      }
      
      #app-loader .energy-wave:nth-child(3) {
        animation-delay: 0.8s;
        border-color: rgba(59, 130, 246, 0.6);
      }
      
      #app-loader .energy-wave:nth-child(4) {
        animation-delay: 1.2s;
        border-color: rgba(168, 85, 247, 0.6);
      }
      
      #app-loader .energy-wave:nth-child(5) {
        animation-delay: 1.6s;
        border-color: rgba(236, 72, 153, 0.6);
      }
      
      /* Particules en orbite */
      #app-loader .particles {
        position: absolute;
        inset: 0;
        display: flex;
        align-items: center;
        justify-content: center;
        pointer-events: none;
      }
      
      #app-loader .particle {
        position: absolute;
        width: 8px;
        height: 8px;
        border-radius: 50%;
        animation: particle-orbit 4s linear infinite;
      }
      
      #app-loader .particle:nth-child(1) { background: #a855f7; animation-delay: 0s; }
      #app-loader .particle:nth-child(2) { background: #ec4899; animation-delay: 0.4s; }
      #app-loader .particle:nth-child(3) { background: #3b82f6; animation-delay: 0.8s; }
      #app-loader .particle:nth-child(4) { background: #a855f7; animation-delay: 1.2s; }
      #app-loader .particle:nth-child(5) { background: #ec4899; animation-delay: 1.6s; }
      #app-loader .particle:nth-child(6) { background: #3b82f6; animation-delay: 2s; }
      #app-loader .particle:nth-child(7) { background: #a855f7; animation-delay: 2.4s; }
      #app-loader .particle:nth-child(8) { background: #ec4899; animation-delay: 2.8s; }
      #app-loader .particle:nth-child(9) { background: #3b82f6; animation-delay: 3.2s; }
      #app-loader .particle:nth-child(10) { background: #a855f7; animation-delay: 3.6s; }
      
      /* Contenu central */
      #app-loader .content {
        position: relative;
        z-index: 10;
        display: flex;
        flex-direction: column;
        align-items: center;
        gap: 3rem;
      }
      
      /* Logo avec mega pulse */
      #app-loader .logo {
        width: 200px;
        height: 200px;
        animation: logo-mega-pulse 2s ease-in-out infinite;
      }
      
      #app-loader .logo img {
        width: 100%;
        height: 100%;
        object-fit: contain;
      }
      
      /* Texte avec glitch */
      #app-loader h2 {
        font-size: 4rem;
        font-weight: 900;
        color: white;
        letter-spacing: 0.2em;
        margin: 0;
        animation: glitch-text 3s infinite;
        font-family: 'Space Grotesk', sans-serif;
      }
      
      /* Barre de progression avec glow */
      #app-loader .progress-bar {
        width: 24rem;
        height: 6px;
        background: rgba(255,255,255,0.1);
        border-radius: 9999px;
        overflow: hidden;
        backdrop-filter: blur(10px);
        animation: progress-glow 2s ease-in-out infinite;
      }
      
      #app-loader .progress-fill {
        height: 100%;
        background: linear-gradient(90deg, 
          #a855f7 0%, 
          #ec4899 33%, 
          #3b82f6 66%, 
          #a855f7 100%);
        background-size: 200% 100%;
        animation: progress-slide 3s ease-out forwards, progress-shimmer 1.5s linear infinite;
      }
      
      @keyframes progress-slide {
        0% { width: 0%; }
        60% { width: 60%; }
        100% { width: 95%; }
      }
      
      @keyframes progress-shimmer {
        0% { background-position: 200% 0; }
        100% { background-position: -200% 0; }
      }
    </style>
    
    <div id="app-loader">
      <!-- Grain animé avec canvas -->
      <canvas id="grain-canvas"></canvas>
      
      <!-- Ondes d'énergie -->
      <div class="energy-waves">
        <div class="energy-wave"></div>
        <div class="energy-wave"></div>
        <div class="energy-wave"></div>
        <div class="energy-wave"></div>
        <div class="energy-wave"></div>
      </div>
      
      <!-- Particules en orbite -->
      <div class="particles">
        <div class="particle"></div>
        <div class="particle"></div>
        <div class="particle"></div>
        <div class="particle"></div>
        <div class="particle"></div>
        <div class="particle"></div>
        <div class="particle"></div>
        <div class="particle"></div>
        <div class="particle"></div>
        <div class="particle"></div>
      </div>
      
      <!-- Contenu central -->
      <div class="content">
        <div class="logo">
          <img src="/nukleo-logo.svg" alt="Nukleo" />
        </div>
        <h2>NUKLEO</h2>
        <div class="progress-bar">
          <div class="progress-fill"></div>
        </div>
      </div>
    </div>
    
    <script>
      // Grain animé avec canvas
      const canvas = document.getElementById('grain-canvas');
      const ctx = canvas.getContext('2d');
      
      function resizeCanvas() {
        canvas.width = window.innerWidth;
        canvas.height = window.innerHeight;
      }
      
      function drawGrain() {
        const imageData = ctx.createImageData(canvas.width, canvas.height);
        const data = imageData.data;
        
        for (let i = 0; i < data.length; i += 4) {
          const value = Math.random() * 255;
          data[i] = value;
          data[i + 1] = value;
          data[i + 2] = value;
          data[i + 3] = 255;
        }
        
        ctx.putImageData(imageData, 0, 0);
      }
      
      resizeCanvas();
      window.addEventListener('resize', resizeCanvas);
      
      // Animer le grain
      setInterval(drawGrain, 50);
      
      // Track start time
      const startTime = Date.now();
      const minDisplayTime = 3000; // 3 seconds minimum
      
      // Hide loader once React renders content (with minimum display time)
      const observer = new MutationObserver(() => {
        const root = document.getElementById('root');
        if (root && root.children.length > 0) {
          const elapsed = Date.now() - startTime;
          const remaining = Math.max(0, minDisplayTime - elapsed);
          
          setTimeout(() => {
            const loader = document.getElementById('app-loader');
            if (loader) {
              loader.style.opacity = '0';
              loader.style.transition = 'opacity 0.5s ease-out';
              setTimeout(() => loader.remove(), 500);
            }
          }, remaining);
          
          observer.disconnect();
        }
      });
      
      observer.observe(document.getElementById('root'), {
        childList: true,
        subtree: true
      });
    </script>
    
    <div id="root"></div>
    <script type="module" src="/src/main.tsx"></script>
  </body>
</html>
